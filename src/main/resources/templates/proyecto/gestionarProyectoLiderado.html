<div class="container">
	
	<div class="row d-flex justify-content-between my-5">
		<div class="col-xl-7 col-lg-6 col-md-12 col-sm-12 col-12">
			<h2 class="display-4"><th:block th:text="|Gestionar ${proyecto.nombre}|"/></h2>
		</div>
		
		<div class="d-flex justify-content-end align-self-center col-xl-5 col-lg-6 col-md-12 col-sm-12 col-12">
			<div>
				<button type="submit" class="btn btn-outline-warning btn-sm border-0 mr-2 botonModoEdicion" onclick="edicionGestionProyecto();">
					<i class="bi bi-pencil"></i>
					 Editar proyecto
				</button>
				<button type="submit" class="btn btn-outline-danger btn-sm border-0 mr-2 botonModoEdicion" onclick="edicionGestionProyecto();" hidden="hidden">
					<i class="bi bi-x-circle"></i>
					 Cancelar edición
				</button>
			</div>
			<form action="/proyecto/verProyecto">
				<input type="hidden" name="idProyecto" th:value="${proyecto.id}"/>
				<button type="submit" class="btn btn-outline-success btn-sm border-0 mr-2">
					<i class="bi bi-eye"></i>
					 Ver proyecto
				</button>
			</form>
			<form action="/usuario/mis_proyectos">
				<button type="submit" class="btn btn-outline-info btn-sm border-0">
					<i class="bi bi-arrow-left"></i>
					 Volver a Mis Proyectos
				</button>
			</form>
		</div>
	</div>
	
</div>

<div class="container p-4">
	<!--************** Información general del proyecto **************-->
	<div class="row">
		<div class="col-xl-5 col-lg-5 col-md-5 col-sm-12 col-12">
			<form action="/proyecto/tuProyecto" method="POST" >
				
				<div class="mt-3">
					<div>
						<h3 class="display-5">Información general:</h3> 
					</div>
				</div>
				<hr class="mb-4">
				
				<div id="jumboGeneralInfo" class="mx-3">
					<div class="form-group">
						<label for="nombreP" class="font-weight-bold">Nombre del proyecto: </label>
						<input type="text" name="nombre" id="nombreP" class="form-control disabled bg-light border-0 inputEdicionProyecto" th:value="${proyecto.nombre}" disabled="disabled">
					</div>
					
					<div class="form-group">
						<label for="descripcionP" class="font-weight-bold">Descripción del proyecto: </label>
						<textarea th:text="${proyecto.descripcion}" name="descripcion" class="form-control disabled bg-light border-0 inputEdicionProyecto" rows="3" disabled="disabled"></textarea>
						<!--<input type="text" name="descripcion" id="descripcionP" class="form-control hiddenInputProyecto" th:value="${proyecto.descripcion}">-->
					</div>
					
					<div class="form-group row">
						<div class="col">
							<label for="inicioP" class="font-weight-bold">Fecha de inicio: </label>
							<input type="date" name="fIni" id="InicioP" class="form-control disabled bg-light border-0 inputEdicionProyecto" th:value="${proyecto.inicio}" disabled="disabled">
						</div>
						<div class="col">
							<label for="finP" class="font-weight-bold">Fecha de fin: </label>
							<input type="date" name="fFin" id="finP" class="form-control disabled bg-light border-0 inputEdicionProyecto" th:value="${proyecto.fin}" disabled="disabled">
						</div>
					</div>
					
					<div class="d-flex justify-content-between">
						<span class="disabled font-weight-light font-italic botonModoEdicion" hidden="hidden" th:text="|ID #${proyecto.id}|"/> 
						<div>
							<input type="hidden" name="idProyecto" th:value="${proyecto.id}" />
							<input type="submit" value="Guardar cambios" class="btn btn-sm btn-outline-success border-0 mr-1 botonEdicion" hidden="hidden" />
							<input type="button" value="Cancelar" class="btn btn-sm btn-outline-danger border-0 botonEdicion" onclick="edicionGestionProyecto();" hidden="hidden"/>
						</div>
					</div>
				</div>
			</form>
		</div>
		
		<!--************** Cards puestos ocupados **************-->
		<div class="col-xl-7 col-lg-7 col-md-7 col-sm-12 col-12">
			<div class="mt-3">
				<div>
					<h3 class="display-5">Tu equipo:</h3> 
				</div>
			</div>
			<hr class="mb-4">
		
			<div class="mx-3 mb-3">
				
				
				<th:block th:each="puesto : ${proyecto.puestos}" class="mx-3">
					<div th:if="${puesto.ocupante != null}" class="card text-center my-3 mx-3">
		  				<div class="card-body">
		  				
		  				<!-- POPUP de edición de puesto desde su propia card -->
		  			
							<button type="button" class="btn btn-outline-info btn-sm float-right border-0 botonEdicion" data-toggle="modal" th:attr="data-target='#modalPuestoOcupado-'+${puesto.id}" hidden="hidden">
								<i class="bi bi-pencil-square"></i>
							</button>
							
							<div class="modal fade text-left" th:id="|modalPuestoOcupado-${puesto.id}|" tabindex="-1" role="dialog" aria-labelledby="modalPuestoOcupadoLabel" aria-hidden="true">
								<div class="modal-dialog modal-dialog-centered" role="document">
									<div class="modal-content">
										<div class="modal-header">
							        		<h5 class="modal-title font-weight-bold" id="modalPuestoOcupadoLabel" th:text="|Estás modificando el puesto de ${puesto.ocupante.nombre}: '${puesto.nombre}'|"></h5>
							        		<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							          			<span aria-hidden="true">&times;</span>
							        		</button>
							      		</div>
							      		<div class="modal-body">
							        		<form>
							          			<div class="form-group">
							            			<label for="recipient-name" class="col-form-label">Modifica el nombre del puesto:</label>
							            			<input type="text" class="form-control" id="recipient-name" th:placeholder="${puesto.nombre}">
							          			</div>
							          			<div class="form-group">
							            			<label for="message-text" class="col-form-label">Nueva descripción del puesto:</label>
							            			<textarea class="form-control" id="message-text" th:text="${puesto.descripcion}"></textarea>
							          			</div>
							            		<span for="message-text" class="col-form-label disabled font-weight-light">Para modificar las habilidades necesarias para este puesto, debe estar desocupado. Por favor, crea uno nuevo o despide a la persona que lo ocupa.</span>
							        		</form>
							      		</div>
							      		<div class="modal-footer d-flex justify-content-between">
							      			<button type="button" class="btn btn-sm btn-outline-danger border-0" data-dismiss="modal" th:text="|Despedir a ${puesto.ocupante.nombre}|"></button>
									      	<div>
									      		<button type="button" class="btn btn-sm btn-outline-secondary border-0" data-dismiss="modal">Cancelar</button>
									        	<button type="button" class="btn btn-sm btn-outline-info border-0">Guardar cambios</button>
									      	</div>
							        
							      		</div>
							    	</div>
								</div>
							</div>
							
							<h5 class="card-title text-left font-weight-bold" th:text="${puesto.nombre}"></h5>
						    <p class="card-text text-left" th:text="|${puesto.ocupante.nombre} ${puesto.ocupante.apellido1} ${puesto.ocupante.apellido2}|"></p>
						    <p class="card-text" th:text="${puesto.descripcion}"></p>
		  				</div>
						<div class="d-inline text-right pb-2 px-2">
						    <span th:each="habilidad : ${puesto.requiere}" th:text="${habilidad.nombre}" class="badge badge-pill badge-primary mx-1"></span>
						</div>
					</div>
				</th:block>
				
			</div>
			
		</div>
		
	</div>
		
	
	<div class="row mt-5 pl-3 d-flex justify-content-between">
	
	
			<div>
				<h3 class="display-5" th:text="|Puestos libres de ${proyecto.nombre}|"></h3> 
			</div>
			
			<div class="align-self-center mr-3">
				<a type="button" th:href="|/puesto/c?nombreProyecto=${proyecto.nombre}|" class="btn btn-outline-info btn-sm border-0 botonEdicion " role="button" title="Crear nuevo puesto" hidden="hidden">
					<i class="bi bi-plus-square"></i> 
					Crear puesto
				</a>
			</div>
		
	</div>
	
	<hr class="mb-4">
	
	<div class="row d-flex justify-content-center">
	<!--************** Cards puestos libres **************-->
		<div class="card-columns">
		
			<th:block th:each="puesto : ${proyecto.puestos}" class="col" id="bloquePuestosLibres">
				<div class="rowCardPuestoLibre">
					<div th:if="${puesto.ocupante == null}" class="card mt-2 mb-4 mx-3" style="width: 18rem;">
						<div class="card-body">
							<button type="button" class="btn btn-outline-info btn-sm float-right border-0 botonEdicion" data-toggle="modal" th:attr="data-target='#modalPuestoLibre-'+${puesto.id}" hidden="hidden">
								<i class="bi bi-pencil-square"></i>
							</button>
							
							<div class="modal fade text-left" th:id="|modalPuestoLibre-${puesto.id}|" tabindex="-1" role="dialog" aria-labelledby="modalPuestoLibreLabel" aria-hidden="true">
								<div class="modal-dialog modal-dialog-centered" role="document">
									<div class="modal-content">
										<div class="modal-header">
							        		<h5 class="modal-title font-weight-bold" id="modalPuestoLibreLabel" th:text="${puesto.nombre}"></h5>
							        		<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							          			<span aria-hidden="true">&times;</span>
							        		</button>
							      		</div>
							      		<div class="modal-body">
							        		<form>
							          			<div class="form-group">
							            			<label for="recipient-name" class="col-form-label">Modifica el nombre del puesto:</label>
							            			<input type="text" class="form-control" id="recipient-name" th:placeholder="${puesto.nombre}">
							          			</div>
							          			<div class="form-group">
							            			<label for="message-text" class="col-form-label">Nueva descripción del puesto:</label>
							            			<textarea class="form-control" id="message-text" th:text="${puesto.descripcion}"></textarea>
							          			</div>
							            		<div class="form-group">
							            			<label for="message-text" class="col-form-label">Reasigna las habilidades necesarias:</label>
							            			<th:block class="mr-2" th:each="habilidad:${habilidades}">
														<input type="checkbox" name="idsHabilidadesRequire[]" th:value="${habilidad.id}" th:id="|id-${habilidad.id}-habilidad|"/>
														<label th:for="|id-${habilidad.id}-habilidad|" th:text="${habilidad.nombre}"/>
													</th:block>
							          			</div>
							        		</form>
							      		</div>
							      		<div class="modal-footer">
									      	<div>
									      		<button type="button" class="btn btn-sm btn-outline-secondary border-0" data-dismiss="modal">Cancelar</button>
									        	<button type="button" class="btn btn-sm btn-outline-info border-0">Guardar cambios</button>
									      	</div>
							        
							      		</div>
							    	</div>
								</div>
							</div>
					  	
						    <h5 th:text="${puesto.nombre}" class="card-title text-left font-weight-bold"></h5>
						    <!--<h6 class="card-subtitle mb-2 text-muted"></h6>-->
						    <p th:text="${puesto.descripcion}" class="card-text"></p>
						    <div class="d-inline pb-1 px-1 text-right">
						    	<span th:each="habilidad : ${puesto.requiere}" th:text="${habilidad.nombre}" class="badge badge-pill badge-primary m-1"></span>
						    </div>
						</div>
					</div>
				</div>
			</th:block>
		</div>
		
	</div>
	
</div>

<script src="/js/edicionGestionProyectos.js"></script>
